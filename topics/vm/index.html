<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-topics/vm" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Compiler and Virtual Machine | IBAX</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ibax-io.github.io/docs/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://ibax-io.github.io/docs/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://ibax-io.github.io/docs/topics/vm"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Compiler and Virtual Machine | IBAX"><meta data-rh="true" name="description" content="compiler-and-virtual-machine}"><meta data-rh="true" property="og:description" content="compiler-and-virtual-machine}"><link data-rh="true" rel="icon" href="/docs/img/ibax.ico"><link data-rh="true" rel="canonical" href="https://ibax-io.github.io/docs/topics/vm"><link data-rh="true" rel="alternate" href="https://ibax-io.github.io/docs/topics/vm" hreflang="en"><link data-rh="true" rel="alternate" href="https://ibax-io.github.io/docs/topics/vm" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://QT93GL41QG-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="IBAX" href="/docs/opensearch.xml"><link rel="stylesheet" href="/docs/assets/css/styles.e4ae71ca.css">
<script src="/docs/assets/js/runtime~main.79890833.js" defer="defer"></script>
<script src="/docs/assets/js/main.599ed462.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/ibax.png" alt="IBAX Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs/img/ibax.png" alt="IBAX Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">IBAX Documentation</b></a></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><a class="navbar__item navbar__link" href="/docs/concepts/about-the-platform">Concept</a><a class="navbar__item navbar__link" href="/docs/tutorials/app_tutorial">Tutorial</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/topics/daemons">Guide</a><a class="navbar__item navbar__link" href="/docs/reference/api2">Reference</a><a class="navbar__item navbar__link" href="/docs/howtos/deployment">Deployment</a><a class="navbar__item navbar__link" href="/docs/needle/intro">Needle</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>English</a><ul class="dropdown__menu"><li><a href="/docs/topics/vm" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="en">English</a></li><li><hr style="margin: 0.3rem 0;"></li><li><a href="https://crowdin.com/project/ibax-docs" target="_blank" rel="noopener noreferrer" class="dropdown__link">Help Us Translate<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><a href="https://github.com/IBAX-io/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/topics/daemons">Daemon</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/topics/script">Smart Contracts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/topics/templates2">Template Language</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/topics/vm">Compiler and Virtual Machine</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Compiler and Virtual Machine</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Compiler and Virtual Machine</h1>
<ul>
<li><a href="#source-code-storage-and-compilation">Source code storage and compilation</a></li>
<li><a href="#virtual-machine-structures">Virtual machine structures</a>
<ul>
<li><a href="#vm-structure">VM Structure</a></li>
<li><a href="#block-structure">Block structure</a></li>
<li><a href="#objinfo-structure">ObjInfo structure</a>
<ul>
<li><a href="#contractinfo-structure">ContractInfo structure</a></li>
<li><a href="#fieldinfo-structure">FieldInfo structure</a></li>
<li><a href="#funcinfo-structure">FuncInfo structure</a></li>
<li><a href="#funcname-structure">FuncName Structure</a></li>
<li><a href="#extfuncinfo-structure">ExtFuncInfo structure</a></li>
<li><a href="#varinfo-structure">VarInfo structure</a></li>
<li><a href="#objextend-value">ObjExtend value</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#virtual-machine-commands">Virtual machine commands</a>
<ul>
<li><a href="#bytecode-structure">ByteCode structure</a></li>
<li><a href="#command-identifiers">Command identifiers</a></li>
<li><a href="#stack-operation-commands">Stack operation commands</a></li>
<li><a href="#runtime-structure">Runtime structure</a>
<ul>
<li><a href="#blockstack-structure">blockStack structure</a></li>
</ul>
</li>
<li><a href="#runcode-function">RunCode function</a></li>
<li><a href="#other-functions-for-operations-with-vm">Other functions for operations with VM</a></li>
</ul>
</li>
<li><a href="#compiler">Compiler</a></li>
<li><a href="#lexical-analyzer">Lexical analyzer</a>
<ul>
<li><a href="#lextable-lextable-go">lextable/lextable.go</a></li>
<li><a href="#lex-go">lex.go</a></li>
</ul>
</li>
<li><a href="#needle-language">Needle language</a>
<ul>
<li><a href="#lexemes">Lexemes</a></li>
<li><a href="#types">Types</a></li>
<li><a href="#expressions">Expressions</a></li>
<li><a href="#scope">Scope</a></li>
<li><a href="#contract-execution">Contract execution</a></li>
<li><a href="#backus-naur-form-bnf">Backus–Naur Form (BNF)</a></li>
</ul>
</li>
</ul>
<p>This section involves program compilation and Needle language operations in the
Virtual Machine (VM).</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="source-code-storage-and-compilation">Source code storage and compilation<a href="#source-code-storage-and-compilation" class="hash-link" aria-label="Direct link to Source code storage and compilation" title="Direct link to Source code storage and compilation">​</a></h2>
<p>Contracts and functions are written with Golang and stored in the contract
tables of ecosystems.</p>
<p>When a contract is executed, its source code will be read from the database and
compiled into bytecode.</p>
<p>When a contract is changed, its source code will be updated and saved in the
database. Then, the source code is compiled, thereby updating the bytecode in
the corresponding virtual machine.</p>
<p>As bytecodes are not physically saved, it will be compiled anew when the program
is executed again.</p>
<p>The entire source code described in the contract table of each ecosystem is
compiled into a virtual machine in strict order, and the status of the virtual
machine is the same on all nodes.</p>
<p>When the contract is called, the virtual machine will not change its status in
any way. The execution of any contract or calling of any function occurs on a
separate running stack created during each external call.</p>
<p>Each ecosystem can have a so-called virtual ecosystem, which can be used within
a node in conjunction with tables outside the blockchain, without direct
affection on the blockchain or other virtual ecosystems. In this case, the node
hosting such a virtual ecosystem will compile its contract and create its own
virtual machine.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="virtual-machine-structures">Virtual machine structures<a href="#virtual-machine-structures" class="hash-link" aria-label="Direct link to Virtual machine structures" title="Direct link to Virtual machine structures">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="vm-structure">VM Structure<a href="#vm-structure" class="hash-link" aria-label="Direct link to VM Structure" title="Direct link to VM Structure">​</a></h3>
<p>A virtual machine is organized in memory as a structure like below.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">type VM struct {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Block</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ExtCost func(string) int64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   FuncCallsDB map[string]struct{}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Extern bool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ShiftContract int64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   logger *log.Entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>A VM structure has the following elements:</p>
<ul>
<li>Block - contains a <a href="#block-structure">block structure</a>;</li>
<li>ExtCost - a function returns the cost of executing an external golang
function;</li>
<li>FuncCallsDB - a collection of Golang function names. This function returns the
execution cost as the first parameter. These functions use EXPLAIN to
calculate the cost of database processing;</li>
<li>Extern - a Boolean flag indicating whether a contract is an external contract.
It is set to true when a VM is created. Contracts called are not displayed
when the code is compiled. In other words, it allows to call the contract code
determined in the future;</li>
<li>ShiftContract - ID of the first contract in the VM;</li>
<li>logger - VM error log output.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="block-structure">Block structure<a href="#block-structure" class="hash-link" aria-label="Direct link to Block structure" title="Direct link to Block structure">​</a></h3>
<p>A virtual machine is a tree composed of <strong>Block type</strong> objects.</p>
<p>A block is an independent unit that contains some bytecodes. In simple terms,
everything you put in the braces (<code>{}</code>) in the language is a block.</p>
<p>For example, the following code would create a block with functions. This block
also contains another block with an if statement, which contains a block with a
while statement.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">func my() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   if true {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      while false {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The block is organized in the memory as a structure like below.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">type Block struct {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Objects map[string]*ObjInfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Type int</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Owner *OwnerInfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Info interface{}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Parent *Block</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Vars []reflect.Type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Code ByteCodes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Children Blocks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>A block structure consists of the following elements:</p>
<ul>
<li><strong>Objects</strong> - a map of internal objects of the pointer type
<a href="#objinfo-structure">ObjInfo</a>. For example, if there is a variable in the
block, you can get information about it by its name;</li>
<li><strong>Type</strong> - the type of the block. For a function block, its type is
<strong>ObjFunc</strong>; for a contract block, its type is <strong>ObjContract</strong>;</li>
<li><strong>Owner</strong> - a structure of <strong>OwnerInfo</strong> pointer type. This structure contains
information about the owner of the compiled contract, which is specified
during contract compilation or obtained from the <strong>contracts</strong> table;</li>
<li><strong>Info</strong> - it contains information about the object, which depends on the
block type;</li>
<li><strong>Parent</strong> - a pointer to the parent block;</li>
<li><strong>Vars</strong> - an array containing the types of current block variables;</li>
<li><strong>Code</strong> - the bytecode of the block itself, which will be executed when the
control rights are passed to the block, for example, function calls or loop
bodies;</li>
<li><strong>Children</strong> - an array containing sub-blocks, such as function nesting,
loops, conditional operators.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="objinfo-structure">ObjInfo structure<a href="#objinfo-structure" class="hash-link" aria-label="Direct link to ObjInfo structure" title="Direct link to ObjInfo structure">​</a></h3>
<p>The ObjInfo structure contains information about internal objects.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">type ObjInfo struct {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Type int</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Value interface{}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The ObjInfo structure has the following elements:</p>
<ul>
<li>
<p><strong>Type</strong> is the object type, which has any of the following values:</p>
<ul>
<li><strong>ObjContract</strong> – <a href="#contractinfo-structure">contract</a>;</li>
<li><strong>ObjFunc</strong> - function;</li>
<li><strong>ObjExtFunc</strong> - external golang function;</li>
<li><strong>ObjVar</strong> - variable;</li>
<li><strong>ObjExtend</strong> - $name variable.</li>
</ul>
</li>
<li>
<p><strong>Value</strong> – it contains the structure of each type.</p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="contractinfo-structure">ContractInfo structure<a href="#contractinfo-structure" class="hash-link" aria-label="Direct link to ContractInfo structure" title="Direct link to ContractInfo structure">​</a></h4>
<p>Pointing to the <strong>ObjContract</strong> type, and the <strong>Value</strong> field contains a
<strong>ContractInfo</strong> structure.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">type ContractInfo struct {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ID uint32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Name string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Owner *OwnerInfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Used map[string]bool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Tx *[]*FieldInfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The ContractInfo structure has the following elements:</p>
<ul>
<li><strong>ID</strong> - contract ID, displayed in the blockchain when calling the contract;</li>
<li><strong>Name</strong> - contract name;</li>
<li><strong>Owner</strong> - other information about the contract;</li>
<li><strong>Used</strong> - map of contracts names that has been called;</li>
<li><strong>Tx</strong> - a data array described in the <a href="/docs/topics/script#data-section">data section</a>
of the contract.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="fieldinfo-structure">FieldInfo structure<a href="#fieldinfo-structure" class="hash-link" aria-label="Direct link to FieldInfo structure" title="Direct link to FieldInfo structure">​</a></h4>
<p>The FieldInfo structure is used in the <strong>ContractInfo</strong> structure and describes
elements in <a href="/docs/topics/script#data-section">data section</a> of a contract.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">type FieldInfo struct {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Name string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Type reflect.Type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Original uint32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Tags string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The FieldInfo structure has the following elements:</p>
<ul>
<li><strong>Name</strong> - field name;</li>
<li><strong>Type</strong> - field type;</li>
<li><strong>Original</strong> - optional field;</li>
<li><strong>Tags</strong> - additional labels for this field.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="funcinfo-structure">FuncInfo structure<a href="#funcinfo-structure" class="hash-link" aria-label="Direct link to FuncInfo structure" title="Direct link to FuncInfo structure">​</a></h4>
<p>Pointing to the ObjFunc type, and the Value field contains a FuncInfo structure.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">type FuncInfo struct {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Params []reflect.Type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Results []reflect.Type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Names *map[string]FuncName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Variadic bool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ID uint32</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The FuncInfo structure has the following elements:</p>
<ul>
<li><strong>Params</strong> - an array of parameter types;</li>
<li><strong>Results</strong> - an array of returned types;</li>
<li><strong>Names</strong> - map of data for tail functions, for example,
<code>DBFind().Columns ()</code>;</li>
<li><strong>Variadic</strong> - true if the function can have a variable number of parameters;</li>
<li><strong>ID</strong> - function ID.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="funcname-structure">FuncName Structure<a href="#funcname-structure" class="hash-link" aria-label="Direct link to FuncName Structure" title="Direct link to FuncName Structure">​</a></h4>
<p>The FuncName structure is used for FuncInfo and describes the data of a tail
function.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">type FuncName struct {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Params []reflect.Type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Offset []int</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Variadic bool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The FuncName structure has the following elements:</p>
<ul>
<li><strong>Params</strong> - an array of parameter types;</li>
<li><strong>Offset</strong> - the array of offsets for these variables. In fact, the values of
all parameters in a function can be initialized with the dot .;</li>
<li><strong>Variadic</strong> - true if the tail function can have a variable number of
parameters.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="extfuncinfo-structure">ExtFuncInfo structure<a href="#extfuncinfo-structure" class="hash-link" aria-label="Direct link to ExtFuncInfo structure" title="Direct link to ExtFuncInfo structure">​</a></h4>
<p>Pointing to the ObjExtFunc type, and the Value field contains a ExtFuncInfo
structure. It is used to describe golang functions.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">type ExtFuncInfo struct {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Name string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Params []reflect.Type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Results []reflect.Type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Auto []string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Variadic bool</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Func interface{}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The ExtFuncInfo structure has the following elements:</p>
<ul>
<li><strong>Name</strong>, <strong>Params</strong>, <strong>Results</strong> parameters have the same structure as
<a href="#funcinfo-structure">FuncInfo</a>;</li>
<li><strong>Auto</strong> - an array of variables. If any, passes to the function as an
additional parameter. For example, a variable of type SmartContract sc;</li>
<li><strong>Func</strong> - golang functions.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="varinfo-structure">VarInfo structure<a href="#varinfo-structure" class="hash-link" aria-label="Direct link to VarInfo structure" title="Direct link to VarInfo structure">​</a></h4>
<p>Pointing to the <strong>ObjVar</strong> type, and the <strong>Value</strong> field contains a <strong>VarInfo</strong>
structure.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">type VarInfo struct {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Obj *ObjInfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Owner *Block</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The VarInfo structure has the following elements:</p>
<ul>
<li><strong>Obj</strong> - information about the type and value of the variable;</li>
<li><strong>Owner</strong> - Pointer to the owner block.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="objextend-value">ObjExtend value<a href="#objextend-value" class="hash-link" aria-label="Direct link to ObjExtend value" title="Direct link to ObjExtend value">​</a></h4>
<p>Pointing to the <strong>ObjExtend</strong> type, and the <strong>Value</strong> field contains a string
containing the name of the variable or function.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="virtual-machine-commands">Virtual machine commands<a href="#virtual-machine-commands" class="hash-link" aria-label="Direct link to Virtual machine commands" title="Direct link to Virtual machine commands">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="bytecode-structure">ByteCode structure<a href="#bytecode-structure" class="hash-link" aria-label="Direct link to ByteCode structure" title="Direct link to ByteCode structure">​</a></h3>
<p>A bytecode is a sequence of <strong>ByteCode</strong> type structures.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">type ByteCode struct {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Cmd uint16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Value interface{}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This structure has the following fields:</p>
<ul>
<li><strong>Cmd</strong> - the identifier of the storage commands;</li>
<li><strong>Value</strong> - contains the operand (value).</li>
</ul>
<p>In general, commands perform an operation on the top element of the stack and
writes the result value into it if necessary.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="command-identifiers">Command identifiers<a href="#command-identifiers" class="hash-link" aria-label="Direct link to Command identifiers" title="Direct link to Command identifiers">​</a></h3>
<p>Identifiers of the virtual machine commands are described in the vm/cmds_list.go
file.</p>
<ul>
<li><strong>cmdPush</strong> – put a value from the Value field to the stack. For example, put
numbers and lines to the stack;</li>
<li><strong>cmdVar</strong> - put the value of a variable to the stack. Value contains a
pointer to the VarInfo structure and information about the variable;</li>
<li><strong>cmdExtend</strong> – put the value of an external variable to the stack. Value
contains a string with the variable name (starting with $);</li>
<li><strong>cmdCallExtend</strong> – call an external function (starting with <code>$</code>). The
parameters of the function are obtained from the stack, and the results are
placed to the stack. Value contains a function name (starting with <code>$</code>);</li>
<li><strong>cmdPushStr</strong> – put the string in Value to the stack;</li>
<li><strong>cmdCall</strong> - calls the virtual machine function. Value contains a <strong>ObjInfo</strong>
structure. This command is applicable to the <strong>ObjExtFunc</strong> golang function
and <strong>ObjFunc</strong> Needle function. If a function is called, its parameters will
be obtained from the stack and the result values will be placed to the stack;</li>
<li><strong>cmdCallVari</strong> - similar to the <strong>cmdCall</strong> command, it calls the virtual
machine function. This command is used to call a function with a variable
number of parameters;</li>
<li><strong>cmdReturn</strong> - used to exit the function. The return values will be put to
the stack, and the Value field is not used;</li>
<li><strong>cmdIf</strong> – transfer control to the bytecode in the <strong>block</strong> structure, which
is passed in the Value field. The control will be transferred to the stack
only when the top element of the stack is called by the <em>valueToBool</em> function
and returned <code>true</code>. Otherwise, the control will be transferred to the next
command;</li>
<li><strong>cmdElse</strong> - this command works in the same way as the <strong>cmdIf</strong>, but only
when the top element of the stack is called by the valueToBool function and
returned <code>false</code>, the control will be transferred to the specified block;</li>
<li><strong>cmdAssignVar</strong> – get a list of variables of type <strong>VarInfo</strong> from Value.
These variables use the <strong>cmdAssign</strong> command to get the value;</li>
<li><strong>cmdAssign</strong> – assign the value in the stack to the variable obtained by the
<strong>cmdAssignVar</strong> command;</li>
<li><strong>cmdLabel</strong> - defines a label when control is returned during the while loop;</li>
<li><strong>cmdContinue</strong> - this command transfers control to the <strong>cmdLabel</strong> label.
When executing a new iteration of the loop, Value is not used;</li>
<li><strong>cmdWhile</strong> – use valueToBool to check the top element of the stack. If this
value is <code>true</code>, the <strong>block</strong> structure will be called from the value field;</li>
<li><strong>cmdBreak</strong> - exits the loop;</li>
<li><strong>cmdIndex</strong> – put the value in map or array into the stack by index, without
using Value. For example,
<code>(map | array) (index value) =&gt; (map | array [index value])</code>;</li>
<li><strong>cmdSetIndex</strong> – assigns the value of the top element of the stack to
elements of map or array, without using Value. For example,
<code>(map | array) (index value) (value) =&gt; (map | array)</code>;</li>
<li><strong>cmdFuncName</strong> - adds parameters that are passed using sequential
descriptions divided by dot . For example,
<code>func name =&gt; Func (...) .Name (...)</code>;</li>
<li><strong>cmdUnwrapArr</strong> - defines a Boolean flag if the top element of the stack is
an array;</li>
<li><strong>cmdMapInit</strong> – initializes the value of map;</li>
<li><strong>cmdArrayInit</strong> – initializes the value of array;</li>
<li><strong>cmdError</strong> - this command is created when a contract or function terminates
with a specified <code>error, warning, info</code>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="stack-operation-commands">Stack operation commands<a href="#stack-operation-commands" class="hash-link" aria-label="Direct link to Stack operation commands" title="Direct link to Stack operation commands">​</a></h3>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>In the current version, automatic type conversion is not fully applicable for
these commands. see <a href="/docs/needle/spec#spec-operator">Operator</a>.</p></div></div>
<p>The following are commands for direct stack processing. The Value field is not
used in these commands.</p>
<ul>
<li><strong>cmdNot</strong> - logical negation. <code>(val) =&gt; (!ValueToBool(val))</code>;</li>
<li><strong>cmdSign</strong> - change of sign. <code>(val) =&gt; (-val)</code>;</li>
<li><strong>cmdAdd</strong> - addition. <code>(val1)(val2) =&gt; (val1 + val2)</code>;</li>
<li><strong>cmdSub</strong> - subtraction. <code>(val1)(val2) =&gt; (val1-val2)</code>;</li>
<li><strong>cmdMul</strong> - multiplication. <code>(val1)(val2) =&gt; (val1 * val2)</code>;</li>
<li><strong>cmdDiv</strong> - division. <code>(val1)(val2) =&gt; (val1 / val2)</code>;</li>
<li><strong>cmdAnd</strong> - logical AND.
<code>(val1)(val2) =&gt; (valueToBool(val1) &amp;&amp; valueToBool(val2))</code>;</li>
<li><strong>cmdOr</strong> - logical OR.
<code>(val1)(val2) =&gt; (valueToBool(val1) || valueToBool(val2))</code>;</li>
<li><strong>cmdEqual</strong> - equality comparison, bool is returned.
<code>(val1)(val2) =&gt; (val1 == val2)</code>;</li>
<li><strong>cmdNotEq</strong> - inequality comparison, bool is returned.
<code>(val1)(val2) =&gt; (val1 != val2)</code>;</li>
<li><strong>cmdLess</strong> - less-than comparison, bool is returned.
<code>(val1)(val2) =&gt; (val1 &lt;val2)</code>;</li>
<li><strong>cmdNotLess</strong> - greater-than-or-equal comparison, bool is returned.
<code>(val1)(val2) =&gt; (val1 &gt;= val2)</code>;</li>
<li><strong>cmdGreat</strong> - greater-than comparison, bool is returned.
<code>(val1)(val2) =&gt; (val1&gt; val2)</code>;</li>
<li><strong>cmdNotGreat</strong> - less-than-or-equal comparison, bool is returned.
<code>(val1)(val2) =&gt; (val1 &lt;= val2)</code>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="runtime-structure">Runtime structure<a href="#runtime-structure" class="hash-link" aria-label="Direct link to Runtime structure" title="Direct link to Runtime structure">​</a></h3>
<p>The execution of bytecodes will not affect the virtual machine. For example, it
allows various functions and contracts to run simultaneously in a single virtual
machine. The Runtime structure is used to run functions and contracts, as well
as any expressions and bytecode.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">type RunTime struct {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   stack []interface{}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   blocks []*blockStack</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   vars []interface{}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   extend *map[string]interface{}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   vm *VM</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   cost int64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   err error</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><strong>stack</strong> - the stack to execute the bytecode;</li>
<li><strong>blocks</strong> - block calls stack;</li>
<li><strong>vars</strong> - stack of variables. Its variable will be added to the stack of
variables when the bytecode is called in the block. After exiting the block,
the size of the stack of variables will return to the previous value;</li>
<li><strong>extend</strong> - a pointer to map with values of external variables (<code>$name</code>);</li>
<li><strong>vm</strong> - a virtual machine pointer;</li>
<li><strong>cost</strong> - fuel unit of the resulting cost of execution;</li>
<li><strong>err</strong> - error occurred during execution.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="blockstack-structure">blockStack structure<a href="#blockstack-structure" class="hash-link" aria-label="Direct link to blockStack structure" title="Direct link to blockStack structure">​</a></h4>
<p>The blockStack structure is used in the Runtime structure.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">type blockStack struct {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Block *Block</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Offset int</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li><strong>Block</strong> - a pointer to the block being executed;</li>
<li><strong>Offset</strong> – the offset of the last command executed in the bytecode of the
specified block.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="runcode-function">RunCode function<a href="#runcode-function" class="hash-link" aria-label="Direct link to RunCode function" title="Direct link to RunCode function">​</a></h3>
<p>Bytecodes are executed in the <strong>RunCode</strong> function. It contains a loop that
performs the corresponding operation for each bytecode command. Before
processing a bytecode, the data required must be initialized.</p>
<p>New blocks are added to other blocks.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rt.blocks = append(rt.blocks, &amp;blockStack{block, len(rt.vars)})</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Next, get the information of relevant parameters of the tail function. These
parameters are contained in the last element of the stack.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var namemap map[string][]interface{}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if block.Type == ObjFunc &amp;&amp; block.Info.(*FuncInfo).Names != nil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   if rt.stack[len(rt.stack)-1] != nil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      namemap = rt.stack[len(rt.stack)-1].(map[string][]interface{})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   rt.stack = rt.stack[:len(rt.stack)-1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then, all variables defined in the current block must be initialized with their
initial values.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">start := len(rt.stack)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">varoff := len(rt.vars)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for vkey, vpar := range block.Vars {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   rt.cost--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   var value interface{}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Since variables in the function are also variables, we need to retrieve them
from the last element of the stack in the order described by the function
itself.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   if block.Type == ObjFunc &amp;&amp; vkey &lt;len(block.Info.(*FuncInfo).Params) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      value = rt.stack[start-len(block.Info.(*FuncInfo).Params)+vkey]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   } else {</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Initialize local variables with their initial values.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">      value = reflect.New(vpar).Elem().Interface()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      if vpar == reflect.TypeOf(map[string]interface{}{}) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         value = make(map[string]interface{})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      } else if vpar == reflect.TypeOf([]interface{}{}) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         value = make([]interface{}, 0, len(rt.vars)+1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   rt.vars = append(rt.vars, value)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Next, update the values of variable parameters passed in the tail function.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">if namemap != nil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   for key, item := range namemap {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      params := (*block.Info.(*FuncInfo).Names)[key]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      for i, value := range item {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         if params.Variadic &amp;&amp; i &gt;= len(params.Params)-1 {</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If variable parameters passed belongs to a variable number of parameters, then
these parameters will be combined into an array of variables.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">            off := varoff + params.Offset[len(params.Params)-1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rt.vars[off] = append(rt.vars[off].([]interface{}), value)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         } else {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            rt.vars[varoff+params.Offset[i]] = value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>After that, all we have to do is delete values passed from the top of the stack
as function parameters, thereby moving the stack. We have copied their values
into a variable array.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">if block.Type == ObjFunc {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   start -= len(block.Info.(*FuncInfo).Params)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When a bytecode command loop finished, we must clear the stack correctly.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">last := rt.blocks[len(rt.blocks)-1]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Delete the current block from the stack of blocks.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">rt.blocks = rt.blocks[:len(rt.blocks)-1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if status == statusReturn {</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If successfully exited from a function already executed, we will add the return
value to the end of the previous stack.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   if last.Block.Type == ObjFunc {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      for count := len(last.Block.Info.(*FuncInfo).Results); count &gt; 0; count-- {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         rt.stack[start] = rt.stack[len(rt.stack)-count]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         start++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      status = statusNormal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   } else {</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>As you can see, if we do not execute the function, then we will not restore the
stack status and exit the function as is. The reason is that loops and
conditional structures that have been executed in the function are also bytecode
blocks.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   return</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rt.stack = rt.stack[:start]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="other-functions-for-operations-with-vm">Other functions for operations with VM<a href="#other-functions-for-operations-with-vm" class="hash-link" aria-label="Direct link to Other functions for operations with VM" title="Direct link to Other functions for operations with VM">​</a></h3>
<p>Your may create a virtual machine with the <strong>NewVM</strong> function. Each virtual
machine will be added with four functions, such as <strong>ExecContract</strong>,
<strong>MemoryUsage</strong>, <strong>CallContract</strong>, and <strong>Settings</strong>, through the <strong>Extend</strong>
function.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">for key, item := range ext.Objects {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   fobj := reflect.ValueOf(item).Type()</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We traverse all the objects passed and only look at the functions.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   switch fobj.Kind() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   case reflect.Func:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We fill the <strong>ExtFuncInfo</strong> structure according to the information received
about the function, and add its structure to the top level map <strong>Objects</strong> by
name.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   data := ExtFuncInfo{key, make([]reflect.Type, fobj.NumIn()), make([]reflect.Type, fobj.NumOut()),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   make([]string, fobj.NumIn()), fobj.IsVariadic(), item}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   for i := 0; i &lt;fobj.NumIn(); i++ {</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <strong>ExtFuncInfo</strong> structure has an <strong>Auto</strong> parameter array. Usually the first
parameter is <code>sc *SmartContract</code> or <code>rt *Runtime</code>, we cannot pass them from
theNeedle language, because they are necessary for us to execute some golang
functions. Therefore, we specify that these variables will be used automatically
when these functions are called. In this case, the first parameter of the above
four functions is <code>rt *Runtime</code>.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   if isauto, ok := ext.AutoPars[fobj.In(i).String()]; ok {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      data.Auto[i] = isauto</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Information about assigning the parameters.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">      data.Params[i] = fobj.In(i)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>And the types of return values.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">for i := 0; i &lt;fobj.NumOut(); i++ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   data.Results[i] = fobj.Out(i)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Adds a function to the root <strong>Objects</strong> so that the compiler can find them later
when using the contract.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">      vm.Objects[key] = &amp;ObjInfo{ObjExtFunc, data}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="compiler">Compiler<a href="#compiler" class="hash-link" aria-label="Direct link to Compiler" title="Direct link to Compiler">​</a></h2>
<p>Functions in the compile.go file are responsible for compiling the array of
tokens obtained from the lexical analyzer. Compilation can be divided into two
levels conditionally. At the top level, we deal with functions, contracts, code
blocks, conditional and loop statements, variable definitions, and so on. At the
lower level, we compile expressions in code blocks or conditions in loops and
conditional statements.</p>
<p>First, we will start from the simple lower level. In the <strong>compileEval</strong>
function, expressions can be converted to bytecode. Since we use a virtual
machine with a stack, it is necessary to convert ordinary infix record
expressions into postfix notation or reverse Polish notation. For example, we
convert <code>1+2</code> to <code>12+</code> and put <code>1</code> and <code>2</code> to the stack. Then, we apply the
addition operation to the last two elements in the stack and write the result to
the stack. You can find this
<a href="https://master.virmandy.net/perevod-iz-infiksnoy-notatsii-v-postfiksnuyu-obratnaya-polskaya-zapis/" target="_blank" rel="noopener noreferrer">conversion</a>
algorithm on the Internet.</p>
<p>The global variable <code>opers = map [uint32] operPrior</code> contains the priority of
operations required for conversion to inverse Polish notation.</p>
<p>The following variables are defined at the beginning of the <strong>compileEval</strong>
function:</p>
<ul>
<li><strong>buffer</strong> - temporary buffer for bytecode commands;</li>
<li><strong>bytecode</strong> - final buffer of bytecode commands;</li>
<li><strong>parcount</strong> - temporary buffer used to calculate parameters when calling a
function;</li>
<li><strong>setIndex</strong> - variables in the work process will be set to true when we
assign map or array elements. For example, <code>a[&quot;my&quot;] = 10</code>. In this case, we
need to use the specified <strong>cmdSetIndex</strong> command.</li>
</ul>
<p>We get a token in a loop and process it accordingly. For example, expression
paring will be stopped if braces are found. When moving the string, we check
whether the previous statement is an operation and whether it is inside the
parentheses, otherwise it will exit the expression is parsed.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">case isRCurly, isLCurly:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   i--</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   if prevLex == isComma || prevLex == lexOper {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return errEndExp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   break main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">case lexNewLine:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   if i &gt; 0 &amp;&amp; ((*lexems)[i-1].Type == isComma || (*lexems)[i-1].Type == lexOper) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      continue main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   for k := len(buffer) - 1; k &gt;= 0; k-- {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   if buffer[k].Cmd == cmdSys {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      continue main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">break main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In general, the algorithm itself corresponds to an algorithm for converting to
inverse Polish notation. With the consideration of the calling of necessary
contracts, functions, and indexes, as well as other things not encountered
during parsing and options for parsing lexIdent type tokens, then, variables,
functions or contracts with this name will be checked. If nothing is found and
this is not a function or contract call, then it will indicate an error.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">objInfo, tobj := vm.findObj(lexem.Value.(string), block)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if objInfo == nil &amp;&amp; (!vm.Extern || i&gt; *ind || i &gt;= len(*lexems)-2 || (*lexems)[i+1].Type != isLPar) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   return fmt.Errorf(`unknown identifier %s`, lexem.Value.(string))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We may encounter such a situation, and the contract call will be described
later. In this example, if no functions or variables with the same name are
found, then we think it is necessary to call a contract. In this compiled
language, there is no difference between contracts and function calls. But we
need to call the contract through the <strong>ExecContract</strong> function used in the
bytecode.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">if objInfo.Type == ObjContract {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   if objInfo.Value != nil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      objContract = objInfo.Value.(*Block)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   objInfo, tobj = vm.findObj(`ExecContract`, block)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   isContract = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We record the number of variables so far in <code>count</code>, which will also be written
to the stack along with the number of function parameters. In each subsequent
detection of parameters, we only need to increase this number by one unit at the
last element of the stack.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">count := 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if (*lexems)[i+2].Type != isRPar {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   count++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>We have a list Used of called parameters for contracts, then we need to mark the
case of the contract is called. If the contract is called without parameters, we
must add two empty parameters to call <strong>ExecContract</strong> to get at least two
parameters.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">if isContract {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   name := StateName((*block)[0].Info.(uint32), lexem.Value.(string))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   for j := len(*block) - 1; j &gt;= 0; j-- {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   topblock := (*block)[j]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      if topblock.Type == ObjContract {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         if topblock.Info.(*ContractInfo).Used == nil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            topblock.Info.(*ContractInfo).Used = make(map[string]bool)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         topblock.Info.(*ContractInfo).Used[name] = true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   bytecode = append(bytecode, &amp;ByteCode{cmdPush, name})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   if count == 0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      count = 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      bytecode = append(bytecode, &amp;ByteCode{cmdPush, &quot;&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      bytecode = append(bytecode, &amp;ByteCode{cmdPush, &quot;&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   count++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>If we see that there is a square bracket next, then we add the <strong>cmdIndex</strong>
command to get the value by the index.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">if (*lexems)[i+1].Type == isLBrack {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   if objInfo == nil || objInfo.Type != ObjVar {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      return fmt.Errorf(`unknown variable %s`, lexem.Value.(string))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   buffer = append(buffer, &amp;ByteCode{cmdIndex, 0})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The <strong>CompileBlock</strong> function can generate object trees and
expression-independent bytecodes. The compilation process is based on a finite
state machine, just like a lexical analyzer, but with the following differences.
First, we do not use symbols but tokens; second, we will immediately describe
the <em>states</em> variables in all states and transitions. It represents an array of
objects indexed by token type. Each token has a structure of <em>compileState</em>, and
a new state is specified in <em>NewState</em>. If it is clear what structure we have
resolved, we can specify the function of the handler in the <em>Func</em> field.</p>
<p>Let us review the main state as an example.</p>
<p>If we encounter a newline or comment, then we will remain in the same state. If
we encounter the <strong>contract</strong> keyword, then we change the state to
<em>stateContract</em> and start parsing the structure. If we encounter the <strong>func</strong>
keyword, then we change the state to <em>stateFunc</em>. If other tokens are received,
the function generating error will be called.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{// stateRoot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   lexNewLine: {stateRoot, 0},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   lexKeyword | (keyContract &lt;&lt; 8): {stateContract | statePush, 0},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   lexKeyword | (keyFunc &lt;&lt; 8): {stateFunc | statePush, 0},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   lexComment: {stateRoot, 0},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0: {errUnknownCmd, cfError},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">},</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Suppose we encountered the <strong>func</strong> keyword and we have changed the state to
<em>stateFunc</em>. Since the function name must follow the <strong>func</strong> keyword, we will
keep the same state when changing the function name. For all other tokens, we
will generate corresponding errors. If we get the function name in the token
identifier, then we go to the <em>stateFParams</em> state, where we can get the
parameters of the function.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{// stateFunc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   lexNewLine: {stateFunc, 0},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   lexIdent: {stateFParams, cfNameBlock},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   0: {errMustName, cfError},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">},</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>At the same time as the above operations, we will call the <strong>fNameBlock</strong>
function. It should be noted that the Block structure is created with the
statePush mark, where we get it from the buffer and fill it with the data we
need. The <strong>fNameBlock</strong> function is suitable for contracts and functions
(including those nested in them). It fills the <em>Info</em> field with the
corresponding structure and writes itself into the <em>Objects</em> of the parent
block. In this way, we can call the function or contract with the specified
name. Similarly, we create corresponding functions for all states and variables.
These functions are usually very small and perform some duties when constructing
the virtual machine tree.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">func fNameBlock(buf *[]*Block, state int, lexem *Lexem) error {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   var itype int</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   prev := (*buf)[len(*buf)-2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   fblock := (*buf)[len(*buf)-1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   name := lexem.Value.(string)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   switch state {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      case stateBlock:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         itype = ObjContract</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         name = StateName((*buf)[0].Info.(uint32), name)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         fblock.Info = &amp;ContractInfo{ID: uint32(len(prev.Children) - 1), Name: name,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         Owner: (*buf)[0].Owner}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      default:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         itype = ObjFunc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         fblock.Info = &amp;FuncInfo{}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   fblock.Type = itype</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   prev.Objects[name] = &amp;ObjInfo{Type: itype, Value: fblock}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   return nil</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>For the <strong>CompileBlock</strong> function, it just traverses all the tokens and switches
states according to the tokens described in states. Almost all additional tokens
correspond to additional program codes.</p>
<ul>
<li><strong>statePush</strong> – adds the <strong>Block</strong> object to the object tree;</li>
<li><strong>statePop</strong> - used when the block ends with a closing brace;</li>
<li><strong>stateStay</strong> - you need to keep the current mark when changing to a new
state;</li>
<li><strong>stateToBlock</strong> - transition to the <strong>stateBlock</strong> state for processing
<em>while</em> and <em>if</em>. After processing expressions, you need to process blocks
within the braces;</li>
<li><strong>stateToBody</strong> - transition to the <strong>stateBody</strong> state;</li>
<li><strong>stateFork</strong> - save the marked position. When the expression starts with an
identifier or a name with <code>$</code>, we can make function calls or assignments;</li>
<li><strong>stateToFork</strong> – used to get the token stored in <strong>stateFork</strong>, which will be
passed to the process function;</li>
<li><strong>stateLabel</strong> – used to insert <strong>cmdLabel</strong> commands. <em>while</em> structure
requires this flag;</li>
<li><strong>stateMustEval</strong> – check the availability of conditional expressions at the
beginning of <em>if</em> and <em>while</em> structures.</li>
</ul>
<p>In addition to the <strong>CompileBlock</strong> function, the <strong>FlushBlock</strong> function should
also be mentioned. But the problem is that the block tree is constructed
independently of existing virtual machines. More precisely, we obtain
information about functions and contracts that exist in a virtual machine, but
we collect the compiled blocks into a separate tree. Otherwise, if an error
occurs during compilation, we must roll back the virtual machine to the previous
state. Therefore, we go to the compilation tree separately, but after the
compilation is successful, the <strong>FlushContract</strong> function must be called. This
function adds the completed block tree to the current virtual machine. The
compilation phase is now complete.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lexical-analyzer">Lexical analyzer<a href="#lexical-analyzer" class="hash-link" aria-label="Direct link to Lexical analyzer" title="Direct link to Lexical analyzer">​</a></h2>
<p>The lexical analyzer processes incoming strings and forms a sequence of tokens
of the following types :</p>
<ul>
<li><strong>lexSys</strong> - system token, for example: <code>{}, [], (), ,, .</code> etc;</li>
<li><strong>lexOper</strong> - operation token, for example: <code>+, -, /, \, *</code>;</li>
<li><strong>lexNumber</strong> - number;</li>
<li><strong>lexident</strong> - identifier;</li>
<li><strong>lexNewline</strong> - newline character;</li>
<li><strong>lexString</strong> - string;</li>
<li><strong>lexComment</strong> - comment;</li>
<li><strong>lexKeyword</strong> - keyword;</li>
<li><strong>lexType</strong> - type;</li>
<li><strong>lexExtend</strong> - reference to external variables or functions, for example:
<code>$myname</code>.</li>
</ul>
<p>In the current version, a conversion table (finite state machine) is initially
constructed with the help of the <a href="#lextable-lextable-go">lextable.go</a> file to
parse the tokens, which is written to the lex_table.go file. In general, you can
get rid of the conversion table initially generated by the file and create a
conversion table in the memory (<code>init()</code>) immediately upon startup. The lexical
analysis itself occurs in the lexParser function in the <a href="#lex-go">lex.go</a> file.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lextable-lextable-go">lextable/lextable.go<a href="#lextable-lextable-go" class="hash-link" aria-label="Direct link to lextable/lextable.go" title="Direct link to lextable/lextable.go">​</a></h3>
<p>Here we define the alphabet to operate and describe how the finite state machine
changes from one state to another based on the next received symbol.</p>
<p><em>states</em> is a JSON object containing a list of states.</p>
<p>Except for specific symbols, <code>d</code> stands for all symbols not specified in the
state. <code>n</code> stands for 0x0a, <code>s</code> stands for space, <code>q</code> stands for backquote, <code>Q</code>
stands for double quote, <code>r</code> stands for character &gt;= 128, <code>a</code> stands for AZ and
az, and <code>1</code> stands for 1- 9.</p>
<p>The name of these states are keys, and the possible values are listed in the
value object. Then, there is a new state to make transitions for each group.
Then there is the name of the token. If we need to return to the initial state,
the third parameter is the service token, which indicates how to handle the
current symbol.</p>
<p>For example, we have the main state and the incoming characters <code>/</code>,
<code>&quot;/&quot;: [&quot;solidus&quot;, &quot;&quot;, &quot;push next&quot;]</code>,</p>
<ul>
<li>
<p><strong>push</strong> - gives the command to remember that it is in a separate stack ;</p>
</li>
<li>
<p><strong>next</strong> - goes to the next character, and at the same time we change the
status to <strong>solidus</strong>. After that, gets the next character and check the
status of <strong>solidus</strong>.</p>
</li>
</ul>
<p>If the next character has <code>/</code> or <code>/*</code>, then we go to the comment <strong>comment</strong>
state because they start with <code>//</code> or <code>/*</code>. Obviously, each comment has a
different state afterwards, because they end with a different symbol.</p>
<p>If the next character is not <code>/</code> and <code>*</code>, then we record everything in the stack
as <strong>lexOper</strong> type tags, clear the stack and return to the main state.</p>
<p>The following module converts the state tree into a numeric array and writes it
into the <em>lex_table.go</em> file.</p>
<p>In the first loop:</p>
<p>We form an alphabet of valid symbols.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">for ind, ch := range alphabet {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   i := byte(ind)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In addition, in <strong>state2int</strong>, we provide each state with its own sequence
identifier.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   state2int := map[string]uint{`main`: 0}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   if err := json.Unmarshal([]byte(states), &amp;data); err == nil {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   for key := range data {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   if key != `main` {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   state2int[key] = uint(len(state2int))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When we traverse all states and each set in a state and each symbol in a set, we
write a three-byte number [new state identifier (0 = main)] + [token type ( 0-no
token)] + [token]. The bidimensionality of the <em>table</em> array is that it is
divided into states and 34 input symbols from the <em>alphabet</em> array, which are
arranged in the same order.</p>
<p>We are in the <em>main</em> state on the zero row of the <em>table</em>. Take the first
character, find its index in the <em>alphabet</em> array, and get the value from the
column with the given index. Starting from the value received, we receive the
token in the low byte. If the parsing is complete, the second byte indicates the
type of token received. In the third byte, we receive the index of the next new
state. All of these are described in more detail in the <strong>lexParser</strong> function
in <em>lex.go</em>.</p>
<p>If you want to add some new characters, you need to add them to the <em>alphabet</em>
array and increase the quantity of the <em>AlphaSize</em> constant. If you want to add
a new symbol combination, it should be described in the status, similar to the
existing options. After the above operation, run the <em>lextable.go</em> file to
update the <em>lex_table.go</em> file.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lex-go">lex-go<a href="#lex-go" class="hash-link" aria-label="Direct link to lex-go" title="Direct link to lex-go">​</a></h3>
<p>The <strong>lexParser</strong> function directly generates lexical analysis and returns an
array of received tags based on incoming strings. Let us analyze the structure
of tokens.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">type Lexem struct {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Type  uint32 // Type of the lexem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Value interface{} // Value of lexem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Line  uint32 // Line of the lexem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Column uint32 // Position inside the line</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>
<p><strong>Type</strong> - token type. It has one of the following values:
<code>lexSys, lexOper, lexNumber, lexIdent, lexString, lexComment, lexKeyword, lexType, lexExtend</code>;</p>
</li>
<li>
<p><strong>Value</strong> – token value. The type of value depends on the token type, Let us
analyze it in more detail:</p>
<ul>
<li><strong>lexSys</strong> - includes brackets, commas, etc. In this case,
<code>Type = ch &lt;&lt; 8 | lexSys</code>, please refer to the <code>isLPar ... isRBrack</code>
constant, and its value is uint32 bits;</li>
<li><strong>lexOper</strong> - the value represents an equivalent character sequence in the
form of uint32. See the <code>isNot ... isOr</code> constants;</li>
<li><strong>lexNumber</strong> - numbers are stored as int64 or float64. If the number has a
decimal point, it is float64;</li>
<li><strong>lexIdent</strong> - identifiers are stored as string;</li>
<li><strong>lexNewLine</strong> - newline character. Also used to calculate the row and token
position;</li>
<li><strong>lexString</strong> - lines are stored as string;</li>
<li><strong>lexComment</strong> - comments are stored as string;</li>
<li><strong>lexKeyword</strong> - for keywords, only the corresponding indexes are stored,
see the <code>keyContract ... keyTail</code> constant. In this case
<code>Type = KeyID &lt;&lt; 8 | lexKeyword</code>. In addition, it should be noted that the
<code>true, false, nil</code> keywords will be immediately converted to lexNumber type
tokens, and the corresponding <code>bool</code> and <code>intreface {}</code> types will be used;</li>
<li><strong>lexType</strong> – this value contains the corresponding <code>reflect.Type</code> type
value;</li>
<li><strong>lexExtend</strong> – identifiers beginning with a <code>$</code>. These variables and
functions are passed from the outside and are therefore assigned to special
types of tokens. This value contains the name as a string without a $ at the
beginning.</li>
</ul>
</li>
<li>
<p><strong>Line</strong> - the line where the token is found;</p>
</li>
<li>
<p><strong>Column</strong> - in-line position of the token.</p>
</li>
</ul>
<p>Let us analyze the <strong>lexParser</strong> function in detail. The <strong>todo</strong> function looks
up the symbol index in the alphabet based on the current state and the incoming
symbol, and obtains a new state, token identifier (if any), and other tokens
from the conversion table. The parsing itself involves calling the <strong>todo</strong>
function in turn for each next character and switching to a new state. Once the
tag is received, we create the corresponding token in the output criteria and
continue the parsing process. It should be noted that during the parsing
process, we do not accumulate the token symbols into a separate stack or array,
because we only save the offset of the start of the token. After getting the
token, we move the offset of the next token to the current parsing position.</p>
<p>All that remains is to check the lexical status tokens used in the parsing:</p>
<ul>
<li><strong>lexfPush</strong> - this token means that we start to accumulate symbols in a new
token;</li>
<li><strong>lexfNext</strong> - the character must be added to the current token;</li>
<li><strong>lexfPop</strong> - the receipt of the token is complete. Usually, with this flag we
have the identifier type of the parsed token;</li>
<li><strong>lexfSkip</strong> - this token is used to exclude characters from parsing. For
example, the control slashes in the string are \n \r &quot;. They will be
automatically replaced during the lexical analysis stage.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="needle-language">Needle language<a href="#needle-language" class="hash-link" aria-label="Direct link to Needle language" title="Direct link to Needle language">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lexemes">Lexemes<a href="#lexemes" class="hash-link" aria-label="Direct link to Lexemes" title="Direct link to Lexemes">​</a></h3>
<p>The source code of a program must be in UTF-8 encoding.</p>
<p>The following lexical types are processed:</p>
<ul>
<li><strong>Keywords</strong> -
<code>action, break, conditions, continue, contract, data, else, error, false, func, If, info, nil, return, settings, true, var, warning, while</code>;</li>
<li><strong>Number</strong> - only decimal numbers are accepted. There are two basic types:
<strong>int</strong> and <strong>float</strong>. If the number has a decimal point, it becomes a float
<strong>float</strong>. <strong>int</strong> type is equivalent to <strong>int64</strong> in golang, while <strong>float</strong>
type is equivalent to <strong>float64</strong> in golang.</li>
<li><strong>String</strong> - the string can be enclosed in double quotes <code>(&quot;a string&quot;)</code> or
backquotes <code>(\`a string\`)</code>. Both types of strings can contain newline
characters. Strings in double quotes can contain double quotes, newline
characters, and carriage returns escaped with slashes. For example,
<code>&quot;This is a \&quot;first string\&quot;.\r\nThis is a second string.&quot;</code>.</li>
<li><strong>Comment</strong> - there are two types of comments. Single-line comments use two
slashes (//). For example, // This is a single-line comment. Multi-line
comments use slash and asterisk symbols and can span multiple lines. For
example, <code>/* This is a multi-line comment */</code>.</li>
<li><strong>Identifier</strong> - the names of variables and functions composed of a-z and A-Z
letters, UTF-8 symbols, numbers and underscores. The name can start with a
letter, underscore, <code>@</code> or <code>$</code>. The name starting with <code>$</code> is the name of the
variable defined in the <strong>data section</strong>. The name starting with <code>$</code> can also
be used to define global variables in the scope of <strong>conditions</strong> and <strong>action
sections</strong>. Ecosystem contracts can be called using the <code>@</code> symbol. For
example: <code>@1NewTable(...)</code>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="types">Types<a href="#types" class="hash-link" aria-label="Direct link to Types" title="Direct link to Types">​</a></h3>
<p>Corresponding golang types are specified next to theNeedle types.</p>
<ul>
<li><strong>bool</strong> - bool, <strong>false</strong> by default;</li>
<li><strong>bytes</strong> - []byte<!-- -->, an empty byte array by default;</li>
<li><strong>int</strong> - int64, <strong>0</strong> by default;</li>
<li><strong>address</strong> - uint64, <strong>0</strong> by default;</li>
<li><strong>array</strong> - []interface<!-- -->, an empty array by default;</li>
<li><strong>map</strong> - map[string]interface<!-- -->, an empty object array by default;</li>
<li><strong>money</strong> - decimal. Decimal, <strong>0</strong> by default;</li>
<li><strong>float</strong> - float64, <strong>0</strong> by default;</li>
<li><strong>string</strong> - string, an empty string by default;</li>
<li><strong>file</strong> - map[string]interface<!-- -->, an empty object array by default.</li>
</ul>
<p>These types of variables are defined with the <code>var</code> keyword. For example,
<code>var var1, var2 int</code>. When defined in this way, a variable will be assigned with
a default value by type.</p>
<p>All variable values are of the interface<!-- --> type, and then they are assigned to
the required golang types. Therefore, for example, array and map types are
golang types []interface<!-- --> and map[string]interface<!-- -->. Both types of arrays can
contain elements of any type.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="expressions">Expressions<a href="#expressions" class="hash-link" aria-label="Direct link to Expressions" title="Direct link to Expressions">​</a></h3>
<p>An expression may include arithmetic operations, logical operations, and
function calls. All expressions are evaluated from left to right by priority of
operators. If having an equal priority, operators are evaluated from left to
right.</p>
<p>Priority of operations from high to low:</p>
<ul>
<li><strong>Function call and parentheses</strong> - when a function is called, passed
parameters will be calculated from left to right;</li>
<li><strong>Unary Operation</strong> - logical negation <code>!</code> and arithmetic sign change <code>-</code>;</li>
<li><strong>Multiplication and Division</strong> - arithmetic multiplication <code>*</code> and division
<code>/</code>;</li>
<li><strong>Addition and Subtraction</strong> - arithmetic addition <code>+</code> and subtraction <code>-</code>;</li>
<li><strong>Logical comparison</strong> - <code>&gt;=&gt;&gt; &gt;=</code>;</li>
<li><strong>Logical equality and inequality</strong> - <code>== !=</code>;</li>
<li><strong>Logical AND</strong> - <code>&amp;&amp;</code>;</li>
<li><strong>Logical OR</strong> - <code>||</code>.</li>
</ul>
<p>When evaluating logical AND and OR, both sides of the expression are evaluated
in any case.</p>
<p>Needle has no type checking during compilation. When evaluating operands, an
attempt is made to convert the type to a more complex type. The type of
complexity order can be as follows: <code>string, int, float, money</code>. Only part of
the type conversions is implemented. The string type supports addition
operations, and the result will be string concatenation. For example,
<code>string + string = string, money-int = money, int * float = float</code>.</p>
<p>For functions, type checking is performed on the <code>string</code> and <code>int</code> types during
execution.</p>
<p><strong>array</strong> and <strong>map</strong> types can be addressed by index. For the <strong>array</strong> type,
the <strong>int</strong> value must be specified as the index. For the <strong>map</strong> type, a
variable or <strong>string</strong> value must be specified. If you assign a value to an
<strong>array</strong> element whose index is greater than the current maximum index, an
empty element will be added to the array. The initial value of these elements is
<strong>nil</strong>. For example: .. code:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var my array</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">my[5] = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var mymap map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mymap[&quot;index&quot;] = my[3]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In expressions of conditional logical values (such as <code>if, while, &amp;&amp;, ||, !</code>),
the type is automatically converted to a logical value. If the type is not the
default value, it is true.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">var mymap map</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var val string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if mymap &amp;&amp; val {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="scope">Scope<a href="#scope" class="hash-link" aria-label="Direct link to Scope" title="Direct link to Scope">​</a></h3>
<p>Braces specify a block that can contain local scope variables. By default, the
scope of a variable extends to its own blocks and all nested blocks. In a block,
you can define a new variable using the name of an existing variable. However,
in this case, external variables with the same name become unavailable.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">var a int</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">a = 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   var a int</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   a = 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Println(a) // 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Println(a) // 3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="contract-execution">Contract execution<a href="#contract-execution" class="hash-link" aria-label="Direct link to Contract execution" title="Direct link to Contract execution">​</a></h3>
<p>When calling a contract, parameters defined in <strong>data</strong> must be passed to it.
Before executing a contract, the virtual machine receives these parameters and
assigns them to the corresponding variables ($Param). Then, the predefined
<strong>conditions</strong> function and <strong>action</strong> function are called.</p>
<p>Errors that occur during contract execution can be divided into two types: form
errors and environment errors. Form errors are generated using special commands:
<code>error, warning, info</code> and when the built-in function returns <code>err</code> not equal to
<em>nil</em>.</p>
<p>The Needle language does not handle exceptions. Any error will terminate the
execution of contracts. Since a separate stack and structure for saving variable
values are created when a contract is executed, the golang garbage collection
mechanism will automatically delete these data when a contract is executed.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="backus-naur-form-bnf">Backus–Naur Form (BNF)<a href="#backus-naur-form-bnf" class="hash-link" aria-label="Direct link to Backus–Naur Form (BNF)" title="Direct link to Backus–Naur Form (BNF)">​</a></h3>
<p>In computer science, BNF is a notation technique for context-free syntax and is
usually used to describe the syntax of the language used in computing.</p>
<ul>
<li>&lt;decimal digit&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;0&#x27; | &#x27;1&#x27; | &#x27;2&#x27; | &#x27;3&#x27; | &#x27;4&#x27; | &#x27;5&#x27; | &#x27;6&#x27; | &#x27;7&#x27; | &#x27;8&#x27; | &#x27;9&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;decimal number&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;decimal digit&gt; {&lt;decimal digit&gt;}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;symbol code&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;&#x27;&#x27;&lt;any symbol&gt;&#x27;&#x27;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;real number&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[&#x27;-&#x27;] &lt;decimal number&#x27;.&#x27;[&lt;decimal number&gt;]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;integer number&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[&#x27;-&#x27;] &lt;decimal number&gt; | &lt;symbol code&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;number&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;&lt;integer number&gt; | &lt;real number&gt;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;letter&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;A&#x27; |&#x27;B&#x27; | ... |&#x27;Z&#x27; |&#x27;a&#x27; |&#x27;b&#x27; | ... |&#x27;z&#x27; | 0x80 | 0x81 | ... | 0xFF</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;space&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;0x20&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;tabulation&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;0x09&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;newline&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;0x0D 0x0A&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;special symbol&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;!&#x27; |&#x27;&quot;&#x27; |&#x27;$&#x27; |&#x27;&#x27;&#x27; |&#x27;(&#x27; |&#x27;)&#x27; |&#x27;\*&#x27; |&#x27;+&#x27; |&#x27;,&#x27; |&#x27;-&#x27; |&#x27;.&#x27; |&#x27;/ &#x27;|&#x27;&lt;&#x27; |&#x27;=&#x27; |&#x27;&gt;&#x27; |&#x27;[&#x27; |&#x27;\\&#x27; |&#x27;]&#x27; |&#x27;_&#x27; |&#x27;|&#x27; |&#x27;}&#x27; | &#x27;{&#x27; | &lt;tabulation&gt; | &lt;space&gt; | &lt;newline&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;symbol&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;decimal digit&gt; | &lt;letter&gt; | &lt;special symbol&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;name&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(&lt;letter&gt; |&#x27;_&#x27;) {&lt;letter&gt; |&#x27;_&#x27; | &lt;decimal digit&gt;}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;function name&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;name&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;variable name&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;name&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;type name&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;name&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;string symbol&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;tabulation&gt; | &lt;space&gt; |&#x27;!&#x27; |&#x27;#&#x27; | ... |&#x27;[&#x27; |&#x27;]&#x27; | ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;string element&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{&lt;string symbol&gt; |&#x27;\&quot;&#x27; |&#x27;\n&#x27; |&#x27;\r&#x27;}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;string&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;&quot;&#x27; {&lt;string element&gt;}&#x27;&quot;&#x27; |&#x27;\`&#x27; {&lt;string element&gt;}&#x27;\`&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;assignment operator&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;=&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;unary operator&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;-&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;binary operator&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;==&#x27; |&#x27;!=&#x27; |&#x27;&gt;&#x27; |&#x27;&lt;&#x27; |&#x27;&lt;=&#x27; |&#x27;&gt;=&#x27; |&#x27;&amp;&amp;&#x27; |&#x27;||&#x27; |&#x27;\*&#x27; |&#x27;/&#x27; |&#x27;+ &#x27;|&#x27;-&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;operator&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;assignment operator&gt; | &lt;unary operator&gt; | &lt;binary operator&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;parameters&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;expression&gt; {&#x27;,&#x27;&lt;expression&gt;}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;contract call&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;contract name&gt;&#x27;(&#x27; [&lt;parameters&gt;]&#x27;)&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;function call&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;contract call&gt; [{&#x27;.&#x27; &lt;name&gt;&#x27;(&#x27; [&lt;parameters&gt;]&#x27;)&#x27;}]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;block contents&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;block command&gt; {&lt;newline&gt;&lt;block command&gt;}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;block&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;{&#x27;&lt;block contents&gt;&#x27;}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;block command&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">(&lt;block&gt; | &lt;expression&gt; | &lt;variables definition&gt; | &lt;if&gt; | &lt;while&gt; | break | continue | return)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;if&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;if &lt;expression&gt;&lt;block&gt; [else &lt;block&gt;]&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;while&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;while &lt;expression&gt;&lt;block&gt;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;contract&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;contract &lt;name&gt; &#x27;{&#x27;[&lt;data section&gt;] {&lt;function&gt;} [&lt;conditions&gt;] [&lt;action&gt;]&#x27;}&#x27;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;data section&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;data &#x27;{&#x27; {&lt;data parameter&gt;&lt;newline&gt;} &#x27;}&#x27;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;data parameter&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;variable name&gt; &lt;type name&gt;&#x27;&quot;&#x27;{&lt;tag&gt;}&#x27;&quot;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;tag&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;optional | image | file | hidden | text | polymap | map | address | signature:&lt;name&gt;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;conditions&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;conditions &lt;block&gt;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;action&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;action &lt;block&gt;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;function&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;func &lt;function name&gt;&#x27;(&#x27;[&lt;variable description&gt;{&#x27;,&#x27;&lt;variable description&gt;}]&#x27;)&#x27;[{&lt;tail&gt;}] [&lt;type name&gt;] &lt;block&gt;&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;variable description&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;variable name&gt; {&#x27;,&#x27; &lt;variable name&gt;} &lt;type name&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;tail&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;.&#x27;&lt;function name&gt;&#x27;(&#x27;[&lt;variable description&gt;{&#x27;,&#x27;&lt;variable description&gt;}]&#x27;)&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>&lt;variables definition&gt;</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;var &lt;variable description&gt;{&#x27;,&#x27;&lt;variable description&gt;}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/IBAX-io/docs/edit/main/docs/topics/vm.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/topics/templates2"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Template Language</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#source-code-storage-and-compilation" class="table-of-contents__link toc-highlight">Source code storage and compilation</a></li><li><a href="#virtual-machine-structures" class="table-of-contents__link toc-highlight">Virtual machine structures</a><ul><li><a href="#vm-structure" class="table-of-contents__link toc-highlight">VM Structure</a></li><li><a href="#block-structure" class="table-of-contents__link toc-highlight">Block structure</a></li><li><a href="#objinfo-structure" class="table-of-contents__link toc-highlight">ObjInfo structure</a></li></ul></li><li><a href="#virtual-machine-commands" class="table-of-contents__link toc-highlight">Virtual machine commands</a><ul><li><a href="#bytecode-structure" class="table-of-contents__link toc-highlight">ByteCode structure</a></li><li><a href="#command-identifiers" class="table-of-contents__link toc-highlight">Command identifiers</a></li><li><a href="#stack-operation-commands" class="table-of-contents__link toc-highlight">Stack operation commands</a></li><li><a href="#runtime-structure" class="table-of-contents__link toc-highlight">Runtime structure</a></li><li><a href="#runcode-function" class="table-of-contents__link toc-highlight">RunCode function</a></li><li><a href="#other-functions-for-operations-with-vm" class="table-of-contents__link toc-highlight">Other functions for operations with VM</a></li></ul></li><li><a href="#compiler" class="table-of-contents__link toc-highlight">Compiler</a></li><li><a href="#lexical-analyzer" class="table-of-contents__link toc-highlight">Lexical analyzer</a><ul><li><a href="#lextable-lextable-go" class="table-of-contents__link toc-highlight">lextable/lextable.go</a></li><li><a href="#lex-go" class="table-of-contents__link toc-highlight">lex-go</a></li></ul></li><li><a href="#needle-language" class="table-of-contents__link toc-highlight">Needle language</a><ul><li><a href="#lexemes" class="table-of-contents__link toc-highlight">Lexemes</a></li><li><a href="#types" class="table-of-contents__link toc-highlight">Types</a></li><li><a href="#expressions" class="table-of-contents__link toc-highlight">Expressions</a></li><li><a href="#scope" class="table-of-contents__link toc-highlight">Scope</a></li><li><a href="#contract-execution" class="table-of-contents__link toc-highlight">Contract execution</a></li><li><a href="#backus-naur-form-bnf" class="table-of-contents__link toc-highlight">Backus–Naur Form (BNF)</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/">Documentation</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/ibaxnetwork" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/IBAX-io/docs" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 IBAX Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>